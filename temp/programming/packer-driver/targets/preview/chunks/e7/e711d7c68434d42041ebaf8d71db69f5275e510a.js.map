{"version":3,"sources":["file:///Users/yamiwang/cowboy/assets/scripts/ui/common/CircleTimer.ts"],"names":["_decorator","Sprite","Label","BaseUI","ccclass","property","CircleTimer","mTotalTime","mRestTime","mCurrentSecond","mSecondCallback","mStartTimer","InitParam","BindUI","RegDataNotify","LateInit","UnregDataNotify","CustmoerDestory","StartTimer","_totalTime","_SecondCallback","Math","ceil","node","active","UpdateCount","UpdateProgress","StopTimer","update","deltaTime","tempSecond","mProgress","fillRange","mCount","string","toString","ratio"],"mappings":";;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAA6BC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;;AACrCC,MAAAA,M,iBAAAA,M;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;6BAGjBM,W,WADZF,OAAO,CAAC,aAAD,C,UAGHC,QAAQ,CAACJ,MAAD,C,UAERI,QAAQ,CAACH,KAAD,C,2BALb,MACaI,WADb;AAAA;AAAA,4BACwC;AAAA;AAAA;;AAAA;;AAAA;;AAAA,eAOpCC,UAPoC,GAOd,CAPc;AAAA,eAQpCC,SARoC,GAQf,CARe;AAAA,eASpCC,cAToC,GASV,CATU;AAAA,eAUpCC,eAVoC,GAUP,IAVO;AAAA,eAWpCC,WAXoC,GAWZ,KAXY;AAAA;;AAYpCC,QAAAA,SAAS,GACT,CAEC;;AACDC,QAAAA,MAAM,GACN,CACC;;AACDC,QAAAA,aAAa,GACb,CACC;;AACDC,QAAAA,QAAQ,GACR,CAEC;;AACDC,QAAAA,eAAe,GACf,CAEC;;AACDC,QAAAA,eAAe,GACf,CAEC;;AAEMC,QAAAA,UAAU,CAACC,UAAD,EAAuBC,eAAvB,EACjB;AACI,eAAKb,UAAL,GAAkBY,UAAlB;AACA,eAAKX,SAAL,GAAiBW,UAAjB;AACA,eAAKV,cAAL,GAAsBY,IAAI,CAACC,IAAL,CAAU,KAAKd,SAAf,CAAtB;AACA,eAAKE,eAAL,GAAuBU,eAAvB;AACA,eAAKT,WAAL,GAAmB,IAAnB;AACA,eAAKY,IAAL,CAAUC,MAAV,GAAmB,IAAnB;AACA,eAAKC,WAAL;AACA,eAAKC,cAAL;AACH;;AAEMC,QAAAA,SAAS,GAChB;AACI,eAAKhB,WAAL,GAAmB,KAAnB;AACA,eAAKY,IAAL,CAAUC,MAAV,GAAmB,KAAnB;AACH;;AAEDI,QAAAA,MAAM,CAACC,SAAD,EACN;AACI,cAAG,KAAKlB,WAAL,IAAoB,KAAvB,EACA;AACI;AACH;;AAED,eAAKH,SAAL,IAAkBqB,SAAlB;AACA,cAAIC,UAAU,GAAGT,IAAI,CAACC,IAAL,CAAU,KAAKd,SAAf,CAAjB;;AACA,cAAGsB,UAAU,IAAI,KAAKrB,cAAtB,EACA;AACI,iBAAKA,cAAL,GAAsBqB,UAAtB;AACA,iBAAKL,WAAL;AACH;;AACD,eAAKC,cAAL;;AACA,cAAG,KAAKlB,SAAL,GAAiB,CAApB,EACA;AACI,iBAAKG,WAAL,GAAmB,KAAnB;AACA,iBAAKoB,SAAL,CAAeC,SAAf,GAA2B,CAA3B;AACH;AACJ;;AAEDP,QAAAA,WAAW,GACX;AACI,eAAKQ,MAAL,CAAYC,MAAZ,GAAqB,KAAKzB,cAAL,CAAoB0B,QAApB,EAArB;;AACA,cAAG,KAAKzB,eAAL,IAAwB,IAA3B,EACA;AACI,iBAAKA,eAAL,CAAqB,KAAKD,cAA1B;AACH;AACJ;;AAEDiB,QAAAA,cAAc,GACd;AACI,cAAIU,KAAK,GAAG,KAAK5B,SAAL,GAAe,KAAKD,UAAhC;AACA,eAAKwB,SAAL,CAAeC,SAAf,GAA2BI,KAA3B;AACH;;AAxFmC,O;;;;;iBAGhB,I;;;;;;;iBAEJ,I","sourcesContent":["import { _decorator, Component, Node, Sprite, Label } from 'cc';\nimport { BaseUI } from '../../base/BaseUI';\nconst { ccclass, property } = _decorator;\n\n@ccclass('CircleTimer')\nexport class CircleTimer extends BaseUI {\n\n    @property(Sprite) \n    mProgress: Sprite = null;\n    @property(Label) \n    mCount: Label = null;\n\n    mTotalTime : number = 0;\n    mRestTime : number = 0;\n    mCurrentSecond : number = 0;\n    mSecondCallback : Function = null;\n    mStartTimer : boolean = false;\n    InitParam() \n    {\n        \n    }\n    BindUI() \n    {\n    }\n    RegDataNotify() \n    {\n    }\n    LateInit() \n    {\n\n    }\n    UnregDataNotify() \n    {\n\n    }\n    CustmoerDestory() \n    {\n\n    }\n\n    public StartTimer(_totalTime : number , _SecondCallback : Function)\n    {\n        this.mTotalTime = _totalTime;\n        this.mRestTime = _totalTime;\n        this.mCurrentSecond = Math.ceil(this.mRestTime);\n        this.mSecondCallback = _SecondCallback;\n        this.mStartTimer = true;\n        this.node.active = true;\n        this.UpdateCount();\n        this.UpdateProgress();\n    }\n\n    public StopTimer()\n    {\n        this.mStartTimer = false;\n        this.node.active = false;\n    }\n\n    update(deltaTime: number) \n    {\n        if(this.mStartTimer == false)\n        {\n            return;\n        }\n\n        this.mRestTime -= deltaTime;\n        let tempSecond = Math.ceil(this.mRestTime);\n        if(tempSecond != this.mCurrentSecond)\n        {\n            this.mCurrentSecond = tempSecond;\n            this.UpdateCount();\n        }\n        this.UpdateProgress();\n        if(this.mRestTime < 0)\n        {\n            this.mStartTimer = false;\n            this.mProgress.fillRange = 0;\n        }\n    }\n\n    UpdateCount()\n    {\n        this.mCount.string = this.mCurrentSecond.toString();\n        if(this.mSecondCallback != null)\n        {\n            this.mSecondCallback(this.mCurrentSecond);\n        }\n    }\n\n    UpdateProgress()\n    {\n        let ratio = this.mRestTime/this.mTotalTime;\n        this.mProgress.fillRange = ratio;\n    }\n}\n\n"]}